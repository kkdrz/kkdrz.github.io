<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.10.0"/><meta name="theme-color" content="#663399"/><meta data-react-helmet="true" name="description" content="In this post I will show you how to make a simple proxy server for SIP protocol.
Recently I spent some time with netty and decided to create some simple…"/><meta data-react-helmet="true" property="og:title" content="SIP proxy server with Netty and SipStack"/><meta data-react-helmet="true" property="og:description" content="In this post I will show you how to make a simple proxy server for SIP protocol.
Recently I spent some time with netty and decided to create some simple…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:title" content="SIP proxy server with Netty and SipStack"/><meta data-react-helmet="true" name="twitter:description" content="In this post I will show you how to make a simple proxy server for SIP protocol.
Recently I spent some time with netty and decided to create some simple…"/><style data-href="/styles.59e449eed886280f1677.css" data-identity="gatsby-global-css">:host,:root{--fa-font-solid:normal 900 1em/1 "Font Awesome 6 Solid";--fa-font-regular:normal 400 1em/1 "Font Awesome 6 Regular";--fa-font-light:normal 300 1em/1 "Font Awesome 6 Light";--fa-font-thin:normal 100 1em/1 "Font Awesome 6 Thin";--fa-font-duotone:normal 900 1em/1 "Font Awesome 6 Duotone";--fa-font-sharp-solid:normal 900 1em/1 "Font Awesome 6 Sharp";--fa-font-sharp-regular:normal 400 1em/1 "Font Awesome 6 Sharp";--fa-font-sharp-light:normal 300 1em/1 "Font Awesome 6 Sharp";--fa-font-brands:normal 400 1em/1 "Font Awesome 6 Brands"}svg:not(:host).svg-inline--fa,svg:not(:root).svg-inline--fa{box-sizing:content-box;overflow:visible}.svg-inline--fa{display:var(--fa-display,inline-block);height:1em;overflow:visible;vertical-align:-.125em}.svg-inline--fa.fa-2xs{vertical-align:.1em}.svg-inline--fa.fa-xs{vertical-align:0}.svg-inline--fa.fa-sm{vertical-align:-.07143em}.svg-inline--fa.fa-lg{vertical-align:-.2em}.svg-inline--fa.fa-xl{vertical-align:-.25em}.svg-inline--fa.fa-2xl{vertical-align:-.3125em}.svg-inline--fa.fa-pull-left{margin-right:var(--fa-pull-margin,.3em);width:auto}.svg-inline--fa.fa-pull-right{margin-left:var(--fa-pull-margin,.3em);width:auto}.svg-inline--fa.fa-li{top:.25em;width:var(--fa-li-width,2em)}.svg-inline--fa.fa-fw{width:var(--fa-fw-width,1.25em)}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{transform-origin:center center}.fa-layers-text{left:50%;top:50%;transform:translate(-50%,-50%);transform-origin:center center}.fa-layers-counter{background-color:var(--fa-counter-background-color,#ff253a);border-radius:var(--fa-counter-border-radius,1em);box-sizing:border-box;color:var(--fa-inverse,#fff);line-height:var(--fa-counter-line-height,1);max-width:var(--fa-counter-max-width,5em);min-width:var(--fa-counter-min-width,1.5em);overflow:hidden;padding:var(--fa-counter-padding,.25em .5em);right:var(--fa-right,0);text-overflow:ellipsis;top:var(--fa-top,0);transform:scale(var(--fa-counter-scale,.25));transform-origin:top right}.fa-layers-bottom-right{bottom:var(--fa-bottom,0);right:var(--fa-right,0);top:auto;transform:scale(var(--fa-layers-scale,.25));transform-origin:bottom right}.fa-layers-bottom-left{bottom:var(--fa-bottom,0);left:var(--fa-left,0);right:auto;top:auto;transform:scale(var(--fa-layers-scale,.25));transform-origin:bottom left}.fa-layers-top-right{right:var(--fa-right,0);top:var(--fa-top,0);transform:scale(var(--fa-layers-scale,.25));transform-origin:top right}.fa-layers-top-left{left:var(--fa-left,0);right:auto;top:var(--fa-top,0);transform:scale(var(--fa-layers-scale,.25));transform-origin:top left}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-2xs{font-size:.625em;line-height:.1em;vertical-align:.225em}.fa-xs{font-size:.75em;line-height:.08333em;vertical-align:.125em}.fa-sm{font-size:.875em;line-height:.07143em;vertical-align:.05357em}.fa-lg{font-size:1.25em;line-height:.05em;vertical-align:-.075em}.fa-xl{font-size:1.5em;line-height:.04167em;vertical-align:-.125em}.fa-2xl{font-size:2em;line-height:.03125em;vertical-align:-.1875em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:var(--fa-li-margin,2.5em);padding-left:0}.fa-ul>li{position:relative}.fa-li{left:calc(var(--fa-li-width, 2em)*-1);line-height:inherit;position:absolute;text-align:center;width:var(--fa-li-width,2em)}.fa-border{border-color:var(--fa-border-color,#eee);border-radius:var(--fa-border-radius,.1em);border-style:var(--fa-border-style,solid);border-width:var(--fa-border-width,.08em);padding:var(--fa-border-padding,.2em .25em .15em)}.fa-pull-left{float:left;margin-right:var(--fa-pull-margin,.3em)}.fa-pull-right{float:right;margin-left:var(--fa-pull-margin,.3em)}.fa-beat{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-beat;animation-timing-function:var(--fa-animation-timing,ease-in-out)}.fa-bounce{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-bounce;animation-timing-function:var(--fa-animation-timing,cubic-bezier(.28,.84,.42,1))}.fa-fade{animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-fade;animation-timing-function:var(--fa-animation-timing,cubic-bezier(.4,0,.6,1))}.fa-beat-fade,.fa-fade{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s)}.fa-beat-fade{animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-beat-fade;animation-timing-function:var(--fa-animation-timing,cubic-bezier(.4,0,.6,1))}.fa-flip{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-flip;animation-timing-function:var(--fa-animation-timing,ease-in-out)}.fa-shake{animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-shake;animation-timing-function:var(--fa-animation-timing,linear)}.fa-shake,.fa-spin{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal)}.fa-spin{animation-duration:var(--fa-animation-duration,2s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-spin;animation-timing-function:var(--fa-animation-timing,linear)}.fa-spin-reverse{--fa-animation-direction:reverse}.fa-pulse,.fa-spin-pulse{animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-spin;animation-timing-function:var(--fa-animation-timing,steps(8))}@media (prefers-reduced-motion:reduce){.fa-beat,.fa-beat-fade,.fa-bounce,.fa-fade,.fa-flip,.fa-pulse,.fa-shake,.fa-spin,.fa-spin-pulse{animation-delay:-1ms;animation-duration:1ms;animation-iteration-count:1;transition-delay:0s;transition-duration:0s}}@keyframes fa-beat{0%,90%{transform:scale(1)}45%{transform:scale(var(--fa-beat-scale,1.25))}}@keyframes fa-bounce{0%{transform:scale(1) translateY(0)}10%{transform:scale(var(--fa-bounce-start-scale-x,1.1),var(--fa-bounce-start-scale-y,.9)) translateY(0)}30%{transform:scale(var(--fa-bounce-jump-scale-x,.9),var(--fa-bounce-jump-scale-y,1.1)) translateY(var(--fa-bounce-height,-.5em))}50%{transform:scale(var(--fa-bounce-land-scale-x,1.05),var(--fa-bounce-land-scale-y,.95)) translateY(0)}57%{transform:scale(1) translateY(var(--fa-bounce-rebound,-.125em))}64%{transform:scale(1) translateY(0)}to{transform:scale(1) translateY(0)}}@keyframes fa-fade{50%{opacity:var(--fa-fade-opacity,.4)}}@keyframes fa-beat-fade{0%,to{opacity:var(--fa-beat-fade-opacity,.4);transform:scale(1)}50%{opacity:1;transform:scale(var(--fa-beat-fade-scale,1.125))}}@keyframes fa-flip{50%{transform:rotate3d(var(--fa-flip-x,0),var(--fa-flip-y,1),var(--fa-flip-z,0),var(--fa-flip-angle,-180deg))}}@keyframes fa-shake{0%{transform:rotate(-15deg)}4%{transform:rotate(15deg)}24%,8%{transform:rotate(-18deg)}12%,28%{transform:rotate(18deg)}16%{transform:rotate(-22deg)}20%{transform:rotate(22deg)}32%{transform:rotate(-12deg)}36%{transform:rotate(12deg)}40%,to{transform:rotate(0deg)}}@keyframes fa-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.fa-rotate-90{transform:rotate(90deg)}.fa-rotate-180{transform:rotate(180deg)}.fa-rotate-270{transform:rotate(270deg)}.fa-flip-horizontal{transform:scaleX(-1)}.fa-flip-vertical{transform:scaleY(-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{transform:scale(-1)}.fa-rotate-by{transform:rotate(var(--fa-rotate-angle,none))}.fa-stack{display:inline-block;height:2em;position:relative;vertical-align:middle;width:2.5em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;z-index:var(--fa-stack-z-index,auto)}.svg-inline--fa.fa-stack-1x{height:1em;width:1.25em}.svg-inline--fa.fa-stack-2x{height:2em;width:2.5em}.fa-inverse{color:var(--fa-inverse,#fff)}.fa-sr-only,.fa-sr-only-focusable:not(:focus),.sr-only,.sr-only-focusable:not(:focus){clip:rect(0,0,0,0);border-width:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.svg-inline--fa .fa-primary{fill:var(--fa-primary-color,currentColor);opacity:var(--fa-primary-opacity,1)}.svg-inline--fa .fa-secondary{fill:var(--fa-secondary-color,currentColor)}.svg-inline--fa .fa-secondary,.svg-inline--fa.fa-swap-opacity .fa-primary{opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-secondary{opacity:var(--fa-primary-opacity,1)}.svg-inline--fa mask .fa-primary,.svg-inline--fa mask .fa-secondary{fill:#000}.fa-duotone.fa-inverse,.fad.fa-inverse{color:var(--fa-inverse,#fff)}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}code,kbd,samp{font-family:monospace,monospace;font-size:1em}img{border-style:none}button,input,optgroup,select,textarea{line-height:1.15}button,input{overflow:visible}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]::-webkit-search-decoration{-webkit-appearance:none}details{display:block}

/*
! tailwindcss v3.3.2 | MIT License | https://tailwindcss.com
*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}html{-webkit-text-size-adjust:100%;font-feature-settings:normal;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-variation-settings:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.m-4{margin:1rem}.m-auto{margin:auto}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:.5rem}.mb-4{margin-bottom:1rem}.mb-6{margin-bottom:1.5rem}.ml-1{margin-left:.25rem}.ml-8{margin-left:2rem}.ml-auto{margin-left:auto}.mr-2{margin-right:.5rem}.mt-1{margin-top:.25rem}.mt-10{margin-top:2.5rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.block{display:block}.flex{display:flex}.hidden{display:none}.h-2{height:.5rem}.h-2\.5{height:.625rem}.h-7{height:1.75rem}.h-full{height:100%}.max-h-40{max-height:10rem}.max-h-80{max-height:20rem}.max-h-96{max-height:24rem}.w-0{width:0}.w-0\.5{width:.125rem}.w-1\/3{width:33.333333%}.w-24{width:6rem}.w-32{width:8rem}.w-48{width:12rem}.w-full{width:100%}.max-w-md{max-width:28rem}.max-w-prose{max-width:65ch}.max-w-screen-lg{max-width:1024px}.max-w-xs{max-width:20rem}.flex-1{flex:1 1 0%}.flex-shrink-0{flex-shrink:0}.grow{flex-grow:1}.rotate-180{--tw-rotate:180deg}.rotate-180,.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}.appearance-none{-webkit-appearance:none;-moz-appearance:none;appearance:none}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.justify-around{justify-content:space-around}.overflow-hidden{overflow:hidden}.whitespace-nowrap{white-space:nowrap}.rounded{border-radius:.25rem}.rounded-full{border-radius:9999px}.rounded-md{border-radius:.375rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-r{border-right-width:1px}.border-r-2{border-right-width:2px}.border-black{--tw-border-opacity:1;border-color:rgb(0 0 0/var(--tw-border-opacity))}.border-gray-400{--tw-border-opacity:1;border-color:rgb(156 163 175/var(--tw-border-opacity))}.bg-blue-500{--tw-bg-opacity:1;background-color:rgb(59 130 246/var(--tw-bg-opacity))}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235/var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}.bg-gray-600{--tw-bg-opacity:1;background-color:rgb(75 85 99/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.object-contain{-o-object-fit:contain;object-fit:contain}.object-cover{-o-object-fit:cover;object-fit:cover}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-8{padding:2rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-8{padding-left:2rem;padding-right:2rem}.py-0{padding-bottom:0;padding-top:0}.py-0\.5{padding-bottom:.125rem;padding-top:.125rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-4{padding-bottom:1rem;padding-top:1rem}.py-8{padding-bottom:2rem;padding-top:2rem}.pb-2{padding-bottom:.5rem}.pb-4{padding-bottom:1rem}.pb-8{padding-bottom:2rem}.pl-1{padding-left:.25rem}.pl-5{padding-left:1.25rem}.pr-1{padding-right:.25rem}.pr-2{padding-right:.5rem}.pt-1{padding-top:.25rem}.pt-2{padding-top:.5rem}.pt-6{padding-top:1.5rem}.text-left{text-align:left}.text-center{text-align:center}.text-justify{text-align:justify}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.italic{font-style:italic}.leading-tight{line-height:1.25}.tracking-wide{letter-spacing:.025em}.text-gray-100{--tw-text-opacity:1;color:rgb(243 244 246/var(--tw-text-opacity))}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219/var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128/var(--tw-text-opacity))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99/var(--tw-text-opacity))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81/var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55/var(--tw-text-opacity))}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color)}.shadow,.shadow-md{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color)}.shadow-md2{--tw-shadow:0 1px 3px rgba(0,0,0,.12),0 1px 2px rgba(0,0,0,.24);--tw-shadow-colored:0 1px 3px var(--tw-shadow-color),0 1px 2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.blur{--tw-blur:blur(8px);filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-200{transition-duration:.2s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}#___gatsby,#gatsby-focus-wrapper,body,html{height:100%}#___gatsby,#gatsby-focus-wrapper,body,h1,h2,h3,h4,h5,h6,html{--tw-text-opacity:1;color:rgb(55 65 81/var(--tw-text-opacity))}h1,h2,h3,h4,h5,h6{font-weight:700;margin-bottom:1rem;margin-top:1rem}h1{font-size:1.875rem;line-height:2.25rem}h2{font-size:1.5rem;line-height:2rem}h3{font-size:1.25rem}h3,h4{line-height:1.75rem}h4{font-size:1.125rem}h5{font-size:1rem;line-height:1.5rem}h6{font-size:.75rem;line-height:1rem}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration-line:none}p{line-height:1.625;margin-bottom:1rem;padding:0}ol,ul{list-style-position:outside;margin-bottom:.5rem;margin-left:1rem}ol{list-style-type:decimal}ul{list-style-type:disc}li>p,ol li,ul li{margin-bottom:.5rem}li :last-child{margin-bottom:0}blockquote{--tw-border-opacity:1;--tw-text-opacity:1;border-color:rgb(37 99 235/var(--tw-border-opacity));border-left-width:1px;color:rgb(107 114 128/var(--tw-text-opacity));font-size:1rem;font-style:italic;line-height:1.5rem;margin-bottom:1.5rem;padding-left:1.5rem}blockquote>:last-child{margin-bottom:0}blockquote>ol,blockquote>ul{list-style-position:inside}table{margin-bottom:2rem;width:100%}table thead tr th:empty{display:none}table thead tr th{border-bottom:1px solid var(--color-accent)}tr:nth-child(odd){--tw-bg-opacity:1;background-color:rgb(229 231 235/var(--tw-bg-opacity))}td,th{padding:.5rem 1rem}a{--tw-text-opacity:1;color:rgb(37 99 235/var(--tw-text-opacity))}a:focus,a:hover{text-decoration-line:underline}.gatsby-highlight{font-size:.875rem;line-height:1.25rem;margin-bottom:1rem}.table-of-contents li{margin-bottom:0}.table-of-contents ul{list-style-type:none}.hover\:bg-blue-700:hover{--tw-bg-opacity:1;background-color:rgb(29 78 216/var(--tw-bg-opacity))}.hover\:text-blue-100:hover{--tw-text-opacity:1;color:rgb(219 234 254/var(--tw-text-opacity))}.hover\:text-gray-900:hover{--tw-text-opacity:1;color:rgb(17 24 39/var(--tw-text-opacity))}.hover\:no-underline:hover{text-decoration-line:none}.hover\:shadow-xl:hover{--tw-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 8px 10px -6px rgba(0,0,0,.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color),0 8px 10px -6px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}@media (prefers-color-scheme:dark){.dark\:bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81/var(--tw-bg-opacity))}}@media (min-width:640px){.sm\:block{display:block}.sm\:hidden{display:none}.sm\:w-1\/3{width:33.333333%}}@media (min-width:768px){.md\:mx-0{margin-left:0;margin-right:0}.md\:ml-7{margin-left:1.75rem}.md\:mt-0{margin-top:0}.md\:flex{display:flex}.md\:h-10{height:2.5rem}.md\:w-1{width:.25rem}.md\:w-128{width:42rem}.md\:w-2\/12{width:16.666667%}.md\:w-72{width:18rem}.md\:max-w-2xl{max-width:42rem}.md\:flex-shrink-0{flex-shrink:0}.md\:flex-row{flex-direction:row}.md\:border-b-0{border-bottom-width:0}.md\:border-r{border-right-width:1px}.md\:pl-4{padding-left:1rem}.md\:pr-4{padding-right:1rem}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}}@media (min-width:1024px){.lg\:h-14{height:3.5rem}.lg\:text-5xl{font-size:3rem;line-height:1}}@media (min-width:1280px){.xl\:flex-row{flex-direction:row}.xl\:flex-wrap{flex-wrap:wrap}.xl\:justify-center{justify-content:center}.xl\:px-6{padding-left:1.5rem;padding-right:1.5rem}}code[class*=language-],pre[class*=language-]{color:#a9b7c6;direction:ltr;font-family:Consolas,Monaco,Andale Mono,monospace;-webkit-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{background:rgba(33,66,131,.85);color:inherit}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:rgba(33,66,131,.85);color:inherit}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2b2b2b}:not(pre)>code[class*=language-]{background-color:rgba(27,31,35,.05);border-radius:6px;color:#24292e;font-size:85%;margin:0 .1em;padding:.2em .4em}.token.cdata,.token.comment,.token.prolog{color:grey}.token.atrule,.token.boolean,.token.delimiter,.token.important,.token.keyword,.token.selector{color:#cc7832}.token.attr-name,.token.operator,.token.punctuation{color:#a9b7c6}.token.builtin,.token.doctype,.token.tag,.token.tag .punctuation{color:#e8bf6a}.token.entity,.token.number,.token.symbol{color:#6897bb}.token.constant,.token.property,.token.variable{color:#9876aa}.token.char,.token.string{color:#6a8759}.token.attr-value,.token.attr-value .punctuation{color:#a5c261}.token.attr-value .punctuation:first-child{color:#a9b7c6}.token.url{color:#287bde;text-decoration:underline}.token.function{color:#ffc66d}.token.regex{background:#364135}.token.bold{font-weight:700}.token.italic{font-style:italic}.token.inserted{background:#294436}.token.deleted{background:#484a4a}code.language-css .token.property,code.language-css .token.property+.token.punctuation{color:#a9b7c6}code.language-css .token.id,code.language-css .token.selector>.token.attribute,code.language-css .token.selector>.token.class,code.language-css .token.selector>.token.pseudo-class,code.language-css .token.selector>.token.pseudo-element{color:#ffc66d}.command-line-prompt{border-right:1px solid #999;display:block;float:left;font-size:100%;letter-spacing:-1px;margin-right:1em;pointer-events:none;text-align:right;-webkit-user-select:none;-moz-user-select:none;user-select:none}.command-line-prompt>span:before{content:" ";display:block;opacity:.7;padding-right:.8em}.command-line-prompt>span[data-user]:before{content:"[" attr(data-user) "@" attr(data-host) "] $"}.command-line-prompt>span[data-user=root]:before{content:"[" attr(data-user) "@" attr(data-host) "] #"}.command-line-prompt>span[data-prompt]:before{content:attr(data-prompt)}.command-line-prompt>span[data-continuation-prompt]:before{content:attr(data-continuation-prompt)}.command-line span.token.output{opacity:.7}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><link rel="alternate" type="application/rss+xml" title="Konrad Drozd Blog RSS Feed" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=eb3297fe92a8ded40e6bcae59c016e56" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=eb3297fe92a8ded40e6bcae59c016e56"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=eb3297fe92a8ded40e6bcae59c016e56"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=eb3297fe92a8ded40e6bcae59c016e56"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=eb3297fe92a8ded40e6bcae59c016e56"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=eb3297fe92a8ded40e6bcae59c016e56"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=eb3297fe92a8ded40e6bcae59c016e56"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=eb3297fe92a8ded40e6bcae59c016e56"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=eb3297fe92a8ded40e6bcae59c016e56"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><title data-react-helmet="true">SIP proxy server with Netty and SipStack | Konrad Drozd: Blog</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="h-full flex flex-col"><header class="p-2 flex text-lg justify-between border-b-2"><div class="flex"><a class="text-gray-800 hover:text-gray-900 py-2 px-4" href="/">kdrozd.pl</a></div><div class="flex"><a class="text-gray-800 hover:text-gray-900 py-2 px-4" href="/blog/">Blog</a><a class="text-gray-800 hover:text-gray-900 py-2 px-4" href="/about/">About me</a></div></header><main class="flex-1"><article class="m-auto px-2 md:w-128 border-b border-gray-400 text-justify" itemscope="" itemType="http://schema.org/Article"><header><h1 class=" font-semibold text-3xl mb-2 text-left" itemProp="headline">SIP proxy server with Netty and SipStack</h1><p class="mb-2 text-sm text-gray-600 leading-tight font-medium flex"><span class="pr-2 mr-2 border-r border-black">Konrad Drozd</span><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="calendar-days" class="svg-inline--fa fa-calendar-days fa-lg pr-1 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M152 24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H64C28.7 64 0 92.7 0 128v16 48V448c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V192 144 128c0-35.3-28.7-64-64-64H344V24c0-13.3-10.7-24-24-24s-24 10.7-24 24V64H152V24zM48 192h80v56H48V192zm0 104h80v64H48V296zm128 0h96v64H176V296zm144 0h80v64H320V296zm80-48H320V192h80v56zm0 160v40c0 8.8-7.2 16-16 16H320V408h80zm-128 0v56H176V408h96zm-144 0v56H64c-8.8 0-16-7.2-16-16V408h80zM272 248H176V192h96v56z"></path></svg>15 June 2021</p><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper w-full mb-4 max-h-96"><div aria-hidden="true" style="padding-top:66.70378619153675%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAIBAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHdR1LCA//EABoQAAICAwAAAAAAAAAAAAAAAAABAhEQISL/2gAIAQEAAQUClZ1ihRoWl//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABsQAAIBBQAAAAAAAAAAAAAAABAxAAERIUFR/9oACAEBAAY/AsR0fC9WH//EABsQAQEAAwADAAAAAAAAAAAAAAERACFBEFGh/9oACAEBAAE/IdBYN6XWWuHw8Nq2UmItt9mCBbM//9oADAMBAAIAAwAAABATz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB4QAQABBAIDAAAAAAAAAAAAAAERACExQRChYXGR/9oACAEBAAE/EGbCCvsN0Q5iJT4mc+euGGdjjWb1KB4QBDG7GeqndQBLuv/Z" alt=""/><picture><source type="image/avif" data-srcset="/static/f7ce6b53d9404a990a7fe9291d72c140/b0356/featured.avif 750w,/static/f7ce6b53d9404a990a7fe9291d72c140/048e5/featured.avif 898w" sizes="100vw"/><source type="image/webp" data-srcset="/static/f7ce6b53d9404a990a7fe9291d72c140/57584/featured.webp 750w,/static/f7ce6b53d9404a990a7fe9291d72c140/9c270/featured.webp 898w" sizes="100vw"/><img data-gatsby-image-ssr="" class="w-full" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/f7ce6b53d9404a990a7fe9291d72c140/f3fc5/featured.jpg" data-srcset="/static/f7ce6b53d9404a990a7fe9291d72c140/7284f/featured.jpg 750w,/static/f7ce6b53d9404a990a7fe9291d72c140/f3fc5/featured.jpg 898w" alt="Front Picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/f7ce6b53d9404a990a7fe9291d72c140/b0356/featured.avif 750w,/static/f7ce6b53d9404a990a7fe9291d72c140/048e5/featured.avif 898w" sizes="100vw"/><source type="image/webp" srcSet="/static/f7ce6b53d9404a990a7fe9291d72c140/57584/featured.webp 750w,/static/f7ce6b53d9404a990a7fe9291d72c140/9c270/featured.webp 898w" sizes="100vw"/><img data-gatsby-image-ssr="" class="w-full" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/f7ce6b53d9404a990a7fe9291d72c140/f3fc5/featured.jpg" srcSet="/static/f7ce6b53d9404a990a7fe9291d72c140/7284f/featured.jpg 750w,/static/f7ce6b53d9404a990a7fe9291d72c140/f3fc5/featured.jpg 898w" alt="Front Picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></header><section itemProp="articleBody"><p>In this post I will show you how to make a simple proxy server for SIP protocol.
Recently I spent some time with <a href="https://netty.io/" target="_blank" rel="nofollow noopener noreferrer">netty</a> and decided to create some simple application to solidify my knowledge.
I will use the <a href="https://www.sipstack.io/getstarted/" target="_blank" rel="nofollow noopener noreferrer">sipstack</a> library as a support for the SIP protocol (decoding, encoding…).
Actually, the protocol that I’ve used doesn’t matter so much, but web is full of HTTP proxies tutorials and I wanted to bring something new.</p>
<p>As always, you will find the final code <a href="github">on my github</a>.</p>
<h2 id="but-why-sip-what-is-it-anyway" style="position:relative;"><a href="#but-why-sip-what-is-it-anyway" aria-label="but why sip what is it anyway permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>But why SIP? What is it anyway?</h2>
<p><a href="https://en.wikipedia.org/wiki/Session_Initiation_Protocol" target="_blank" rel="nofollow noopener noreferrer">SIP</a> stands for <em>Session Initiation Protocol</em>.
In simple words, this protocol is used to set up sessions between clients,
for example in IP telephony (<a href="https://en.wikipedia.org/wiki/Voice_over_IP" target="_blank" rel="nofollow noopener noreferrer">Voice over Internet Protocol</a>).
This is the protocol that we use when writing <a href="https://en.wikipedia.org/wiki/Value-added_service" target="_blank" rel="nofollow noopener noreferrer">value-added-services</a> in my current job.
An extremely simplified diagram of how this protocol works looks like this:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/fc64c37a9c81ce4c5b13a70179bbaff8/715a3/sip_flow.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 69.62025316455697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4UlEQVR42oVUyW7UUBD073LjhsQNvinckFhuKHDgEBGUQTjjjMceb8/rW+1C9Sa2bLK11PKblru6q+p5Aqximiac8gLjOK7LiI8pwttoU3PjiDTLfc86gg3gOOLL9yv0w7AMYLx++w6v3ryHMWZ5V2qDT99+PhgeOBlDdxFUt4cdYsTxnZ9O8BkgSVOcsmIzxLkRSXLCNDpusmRgu7+Q9Q0G8Rum2UEPFYx16LoOVVXBWgulFJxzHkwI4Wv8zef/Ebj2Bkr8ghLXcN0ORtXwS6y04abDMEBK6Yf0fQ8pNVpxhK6vfa8kRrNDYMUP1MevEPFn2OoSTRFCG+cb4zhegLhxXdcIwxB5nkObEV35B83dB5S3FxD7C7Txx60pDE7XWvumw+HggUh5zqZp/BBjLbRs4VQBPZxgZObPDwBJj87NW1Ernvk8m+EWc+bzk9fGXwcpF5pMbsutmayXZekHtW2LrmsJjWl2GdMWkJtRp6IofCMdJW3qyTqBuBndnd1/9mITkC/NDaSfJAmiKPJmEJwaKiWhjUVfJ2eHyyvYPnqaMsFIKcsyrxNpzzqSujEaWhso3tl+D9WG/qN4FJA6MUk7TVMPQOqzpnT/DGo8mxdNecw5SrHWbT5z8/t/gfsE/gFqcD4ekDYh7QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Simple SIP flow"
        title="Open image"
        src="/static/fc64c37a9c81ce4c5b13a70179bbaff8/f058b/sip_flow.png"
        srcset="/static/fc64c37a9c81ce4c5b13a70179bbaff8/c26ae/sip_flow.png 158w,
/static/fc64c37a9c81ce4c5b13a70179bbaff8/6bdcf/sip_flow.png 315w,
/static/fc64c37a9c81ce4c5b13a70179bbaff8/f058b/sip_flow.png 630w,
/static/fc64c37a9c81ce4c5b13a70179bbaff8/715a3/sip_flow.png 830w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>I chose this protocol in order to expand my competences.
Perhaps, in addition to learning, this playground will be useful for something at work :)</p>
<h2 id="objective" style="position:relative;"><a href="#objective" aria-label="objective permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Objective</h2>
<p>The application will work exactly as shown in the diagram above.
Messages will be sent without making any changes to them. This will be a so-called <a href="https://www.tutorialspoint.com/session_initiation_protocol/session_initiation_protocol_proxies_and_routing.htm" target="_blank" rel="nofollow noopener noreferrer">stateless proxy</a>.</p>
<blockquote>
<p>Stateless proxies forget about the SIP request once it has been forwarded. This kind of server does not store any information of the call or transaction.</p>
</blockquote>
<p>Information about who is the addressee of the message will be included in the <code class="language-text">Route</code> header.</p>
<p><strong>Technologies used:</strong></p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://netty.io/" target="_blank" rel="nofollow noopener noreferrer">Netty</a></td>
</tr>
<tr>
<td><a href="https://www.sipstack.io/getstarted/" target="_blank" rel="nofollow noopener noreferrer">SipStack</a></td>
</tr>
<tr>
<td><a href="https://github.com/SIPp/sipp" target="_blank" rel="nofollow noopener noreferrer">SIPp</a> (for functional testing)</td>
</tr>
<tr>
<td><a href="https://kotlinlang.org/" target="_blank" rel="nofollow noopener noreferrer">Kotlin</a> (as part of learning 😊)</td>
</tr>
<tr>
<td><a href="https://gradle.org/" target="_blank" rel="nofollow noopener noreferrer">Gradle</a></td>
</tr>
</tbody>
</table>
<h2 id="project-setup" style="position:relative;"><a href="#project-setup" aria-label="project setup permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Project setup</h2>
<p>I started from generating a <em>hello-world</em> template using IntelliJ and added the necessary dependencies:</p>
<div class="gatsby-highlight" data-language="gradle"><pre style="counter-reset: linenumber NaN" class="language-gradle line-numbers"><code class="language-gradle"><span class="token keyword">dependencies</span> <span class="token punctuation">{</span>
<span class="token comment">//    SIP support</span>
    <span class="token keyword">implementation</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">"io.sipstack:sipstack-netty-codec-sip:0.1.1"</span></span><span class="token punctuation">)</span>
    
<span class="token comment">//    logging</span>
    <span class="token keyword">implementation</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">"org.slf4j:slf4j-api:1.7.30"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">implementation</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">"ch.qos.logback:logback-classic:1.2.3"</span></span><span class="token punctuation">)</span>
    <span class="token keyword">implementation</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">"ch.qos.logback:logback-core:1.2.3"</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2 id="set-up-netty-server" style="position:relative;"><a href="#set-up-netty-server" aria-label="set up netty server permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Set up netty server</h2>
<p>Then I created a main class <code class="language-text">ProxyApp</code> that runs the netty server.</p>
<p>In the code I took the following nomenclature:</p>
<ul>
<li><code class="language-text">upstream</code> - this is where the messages originally come (Bob)</li>
<li><code class="language-text">downstream</code> - this is where the messages are proxied (Alice)</li>
</ul>
<div class="gatsby-highlight" data-language="kotlin"><pre style="counter-reset: linenumber NaN" class="language-kotlin line-numbers"><code class="language-kotlin"><span class="token keyword">package</span> pl<span class="token punctuation">.</span>kdrozd<span class="token punctuation">.</span>examples<span class="token punctuation">.</span>sipproxy

<span class="token keyword">import</span> io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>bootstrap<span class="token punctuation">.</span>ServerBootstrap
<span class="token keyword">import</span> io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>channel<span class="token punctuation">.</span>Channel
<span class="token keyword">import</span> io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>channel<span class="token punctuation">.</span>ChannelInitializer
<span class="token keyword">import</span> io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>channel<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>NioEventLoopGroup
<span class="token keyword">import</span> io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>channel<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>NioServerSocketChannel
<span class="token keyword">import</span> io<span class="token punctuation">.</span>sipstack<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>sip<span class="token punctuation">.</span>SipMessageEncoder
<span class="token keyword">import</span> io<span class="token punctuation">.</span>sipstack<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>sip<span class="token punctuation">.</span>SipMessageStreamDecoder
<span class="token keyword">import</span> org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>LoggerFactory
<span class="token keyword">import</span> java<span class="token punctuation">.</span>net<span class="token punctuation">.</span>InetSocketAddress

<span class="token keyword">class</span> <span class="token function">ProxyApp</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">val</span> hostname<span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token keyword">private</span> <span class="token keyword">val</span> port<span class="token operator">:</span> Int<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">var</span> upstreamChannel<span class="token operator">:</span> Channel<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>

    <span class="token keyword">fun</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> workGroup <span class="token operator">=</span> <span class="token function">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> bossGroup <span class="token operator">=</span> <span class="token function">NioEventLoopGroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> b <span class="token operator">=</span> <span class="token function">ServerBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>bossGroup<span class="token punctuation">,</span> workGroup<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span>NioServerSocketChannel<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">childHandler</span><span class="token punctuation">(</span><span class="token keyword">object</span> <span class="token operator">:</span> ChannelInitializer<span class="token operator">&lt;</span>Channel<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">initChannel</span><span class="token punctuation">(</span>ch<span class="token operator">:</span> Channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">with</span><span class="token punctuation">(</span>ch<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">addLast</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"decoder"</span></span><span class="token punctuation">,</span> <span class="token function">SipMessageStreamDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token function">addLast</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"encoder"</span></span><span class="token punctuation">,</span> <span class="token function">SipMessageEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> socketAddress <span class="token operator">=</span> <span class="token function">InetSocketAddress</span><span class="token punctuation">(</span>hostname<span class="token punctuation">,</span> port<span class="token punctuation">)</span>
        <span class="token keyword">val</span> f <span class="token operator">=</span> b<span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>socketAddress<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        upstreamChannel <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fun</span> <span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>upstreamChannel<span class="token operator">?</span><span class="token punctuation">.</span>isActive <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            upstreamChannel<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>This class is not very interesting and looks like most of the other classes that bootstrap netty.
We use <code class="language-text">NioServerSocketChannel</code>, because we want to use <code class="language-text">TCP</code> protocol.
In the case of <code class="language-text">UDP</code>, we would use <code class="language-text">NioDatagramChannel</code>.
If you need more explanation of what’s going on here, check out <a href="https://netty.io/wiki/user-guide-for-4.x.html#writing-a-discard-server" target="_blank" rel="nofollow noopener noreferrer">the netty documentation</a>.</p>
<p>The most interesting part is setting up the message decoder/encoder:</p>
<div class="gatsby-highlight" data-language="kotlin"><pre style="counter-reset: linenumber NaN" class="language-kotlin line-numbers"><code class="language-kotlin">b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>bossGroup<span class="token punctuation">,</span> workGroup<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span>NioServerSocketChannel<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">childHandler</span><span class="token punctuation">(</span><span class="token keyword">object</span> <span class="token operator">:</span> ChannelInitializer<span class="token operator">&lt;</span>Channel<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">initChannel</span><span class="token punctuation">(</span>ch<span class="token operator">:</span> Channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">with</span><span class="token punctuation">(</span>ch<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">addLast</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"decoder"</span></span><span class="token punctuation">,</span> <span class="token function">SipMessageStreamDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token function">addLast</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"encoder"</span></span><span class="token punctuation">,</span> <span class="token function">SipMessageEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p><code class="language-text">SipMessageStreamDecoder</code> is the decoder for the incoming data. It decodes bytes to <code class="language-text">SipMessageEvent</code> and works for stream based protocols (TCP).
If you want to use datagram based protocols (UDP), there is an alternative: <code class="language-text">SipMessageDatagramDecoder</code>.</p>
<p><code class="language-text">SipMessageEncoder</code> encodes <code class="language-text">SipMessageEvent</code> back to bytes. It is used for both TCP and UDP.</p>
<p>With a simple <code class="language-text">main</code> method we can run the service:</p>
<div class="gatsby-highlight" data-language="kotlin"><pre style="counter-reset: linenumber NaN" class="language-kotlin line-numbers"><code class="language-kotlin"><span class="token keyword">package</span> pl<span class="token punctuation">.</span>kdrozd<span class="token punctuation">.</span>examples<span class="token punctuation">.</span>sipproxy

<span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> app <span class="token operator">=</span> <span class="token function">ProxyApp</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"127.0.0.1"</span></span><span class="token punctuation">,</span> <span class="token number">5060</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2 id="create-handlers" style="position:relative;"><a href="#create-handlers" aria-label="create handlers permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create handlers</h2>
<p>After startup, our server is able to accept messages,
but we haven’t added any message handler to the pipeline, so it doesn’t do anything with them.</p>
<p>Below is the <strong><code class="language-text">ProxyUpstreamHandler</code></strong> implementation.
This is the handler responsible for receiving messages from <code class="language-text">upstream</code>, creating connection with <code class="language-text">downstream</code> and proxying the messages.</p>
<div class="gatsby-highlight" data-language="kotlin"><pre style="counter-reset: linenumber NaN" class="language-kotlin line-numbers"><code class="language-kotlin"><span class="token keyword">package</span> pl<span class="token punctuation">.</span>kdrozd<span class="token punctuation">.</span>examples<span class="token punctuation">.</span>sipproxy

<span class="token keyword">import</span> io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>bootstrap<span class="token punctuation">.</span>Bootstrap
<span class="token keyword">import</span> io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>buffer<span class="token punctuation">.</span>Unpooled
<span class="token keyword">import</span> io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>channel<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>channel<span class="token punctuation">.</span>socket<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>NioSocketChannel
<span class="token keyword">import</span> io<span class="token punctuation">.</span>pkts<span class="token punctuation">.</span>packet<span class="token punctuation">.</span>sip<span class="token punctuation">.</span>SipMessage
<span class="token keyword">import</span> io<span class="token punctuation">.</span>pkts<span class="token punctuation">.</span>packet<span class="token punctuation">.</span>sip<span class="token punctuation">.</span>address<span class="token punctuation">.</span>SipURI
<span class="token keyword">import</span> io<span class="token punctuation">.</span>sipstack<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>sip<span class="token punctuation">.</span>SipMessageEncoder
<span class="token keyword">import</span> io<span class="token punctuation">.</span>sipstack<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>sip<span class="token punctuation">.</span>SipMessageEvent
<span class="token keyword">import</span> io<span class="token punctuation">.</span>sipstack<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>sip<span class="token punctuation">.</span>SipMessageStreamDecoder
<span class="token keyword">import</span> org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>LoggerFactory

<span class="token keyword">class</span> ProxyUpstreamHandler <span class="token operator">:</span> SimpleChannelInboundHandler<span class="token operator">&lt;</span>SipMessageEvent<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 1</span>

    <span class="token keyword">private</span> <span class="token keyword">var</span> downstreamChannel<span class="token operator">:</span> Channel<span class="token operator">?</span> <span class="token operator">=</span> <span class="token keyword">null</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">channelRead0</span><span class="token punctuation">(</span> <span class="token comment">// 2</span>
        ctx<span class="token operator">:</span> ChannelHandlerContext<span class="token punctuation">,</span>
        event<span class="token operator">:</span> SipMessageEvent
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> msg <span class="token operator">=</span> event<span class="token punctuation">.</span>message
        <span class="token keyword">val</span> upstreamChannel<span class="token operator">:</span> Channel <span class="token operator">=</span> ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">val</span> f<span class="token operator">:</span> ChannelFuture <span class="token operator">=</span> <span class="token function">connectWithDownstream</span><span class="token punctuation">(</span>upstreamChannel<span class="token punctuation">,</span> msg<span class="token punctuation">)</span> <span class="token comment">// 3</span>

        f<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>ChannelFutureListener <span class="token punctuation">{</span> connectionCompleteFuture<span class="token operator">:</span> ChannelFuture <span class="token operator">-></span> <span class="token comment">// 4</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>connectionCompleteFuture<span class="token punctuation">.</span>isSuccess<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">closeAndFlush</span><span class="token punctuation">(</span>upstreamChannel<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>

            downstreamChannel <span class="token operator">=</span> connectionCompleteFuture<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">proxyMessageToDownstream</span><span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> msg<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">connectWithDownstream</span><span class="token punctuation">(</span>
        upstreamChannel<span class="token operator">:</span> Channel<span class="token punctuation">,</span>
        msg<span class="token operator">:</span> SipMessage
    <span class="token punctuation">)</span><span class="token operator">:</span> ChannelFuture <span class="token punctuation">{</span>
        <span class="token keyword">val</span> b <span class="token operator">=</span> <span class="token function">Bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>upstreamChannel<span class="token punctuation">.</span><span class="token function">eventLoop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span>NioSocketChannel<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">handler</span><span class="token punctuation">(</span><span class="token keyword">object</span> <span class="token operator">:</span> ChannelInitializer<span class="token operator">&lt;</span>Channel<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">initChannel</span><span class="token punctuation">(</span>ch<span class="token operator">:</span> Channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">with</span><span class="token punctuation">(</span>ch<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">addLast</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"decoder"</span></span><span class="token punctuation">,</span> <span class="token function">SipMessageStreamDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token function">addLast</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"encoder"</span></span><span class="token punctuation">,</span> <span class="token function">SipMessageEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token function">addLast</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"handler"</span></span><span class="token punctuation">,</span> <span class="token function">ProxyDownstreamHandler</span><span class="token punctuation">(</span>upstreamChannel<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 5</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">val</span> routeHeader <span class="token operator">=</span> msg<span class="token punctuation">.</span>routeHeader<span class="token punctuation">.</span>address<span class="token punctuation">.</span>uri <span class="token keyword">as</span> SipURI <span class="token comment">// 6</span>
        <span class="token keyword">return</span> b<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>routeHeader<span class="token punctuation">.</span>host<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> routeHeader<span class="token punctuation">.</span>port<span class="token punctuation">)</span> <span class="token comment">// 7</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">fun</span> <span class="token function">proxyMessageToDownstream</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> ChannelHandlerContext<span class="token punctuation">,</span> msg<span class="token operator">:</span> SipMessage<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        downstreamChannel<span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">writeAndFlush</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token operator">?</span><span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>
            ChannelFutureListener <span class="token punctuation">{</span> messageProxiedFuture<span class="token operator">:</span> ChannelFuture <span class="token operator">-></span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>messageProxiedFuture<span class="token punctuation">.</span>isSuccess<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token function">closeAndFlush</span><span class="token punctuation">(</span>messageProxiedFuture<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">exceptionCaught</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> ChannelHandlerContext<span class="token punctuation">,</span> cause<span class="token operator">:</span> Throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 8</span>
        cause<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">closeAndFlush</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token punctuation">{</span>

        <span class="token keyword">fun</span> <span class="token function">closeAndFlush</span><span class="token punctuation">(</span>ch<span class="token operator">:</span> Channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ch<span class="token punctuation">.</span>isActive<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                ch<span class="token punctuation">.</span><span class="token function">writeAndFlush</span><span class="token punctuation">(</span>Unpooled<span class="token punctuation">.</span>EMPTY_BUFFER<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>ChannelFutureListener<span class="token punctuation">.</span>CLOSE<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>This class is a bit more complicated, so I will try to describe the most important parts:</p>
<ol>
<li>Since <code class="language-text">SipMessageStreamDecoder</code> decodes bytes to <code class="language-text">SipMessageEvent</code> we need our handler to operate with this class.</li>
</ol>
<p>That’s why we extend the <code class="language-text">SimpleChannelInboundHandler&lt;SipMessageEvent></code> class.</p>
<ol start="2">
<li><code class="language-text">channelRead0</code> method is called whenever new data is received from client.</li>
</ol>
<p>Thanks to the fact that we extend the <code class="language-text">SimpleChannelInboundHandler&lt;SipMessageEvent></code> class, as an input we get a decoded <code class="language-text">SipMessageEvent</code>.</p>
<ol start="3">
<li>
<p>We set up a connection between proxy server and the destination. The setup is very similar to the one from <code class="language-text">ProxyApp</code> class.</p>
</li>
<li>
<p>As soon as the connection is established, we want to send a message to the destination,</p>
</li>
</ol>
<p>that is why we set up a listener. If anything goes wrong with the connection or message transfer, we just close the channel.</p>
<ol start="5">
<li>
<p><code class="language-text">ProxyDownstreamHandler</code> is a handler for messages that come from the destination. I will describe it later.</p>
</li>
<li>
<p>Here, we try to read the destination address from <code class="language-text">Route</code> header.</p>
</li>
</ol>
<p>I could use some security in case this header is not defined, but I don’t want to complicate the code.</p>
<ol start="7">
<li>
<p>Here, the connection is started.</p>
</li>
<li>
<p>If we get an exception along the way, we also just close the channel.</p>
</li>
</ol>
<p><strong><code class="language-text">ProxyDownstreamHandler</code></strong> is much simplier.
Any message that arrives is simply sent to the upstream channel.
If the <code class="language-text">server &lt;-> downstream</code> channel is deactivated, we close the <code class="language-text">server &lt;-> upstream</code> channel as well.
As before, in case of any failure/exception, we close the channel.</p>
<div class="gatsby-highlight" data-language="kotlin"><pre style="counter-reset: linenumber NaN" class="language-kotlin line-numbers"><code class="language-kotlin"><span class="token keyword">package</span> pl<span class="token punctuation">.</span>kdrozd<span class="token punctuation">.</span>examples<span class="token punctuation">.</span>sipproxy

<span class="token keyword">import</span> io<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>channel<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">import</span> io<span class="token punctuation">.</span>sipstack<span class="token punctuation">.</span>netty<span class="token punctuation">.</span>codec<span class="token punctuation">.</span>sip<span class="token punctuation">.</span>SipMessageEvent
<span class="token keyword">import</span> org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span>LoggerFactory
<span class="token keyword">import</span> pl<span class="token punctuation">.</span>kdrozd<span class="token punctuation">.</span>examples<span class="token punctuation">.</span>sipproxy<span class="token punctuation">.</span>ProxyUpstreamHandler<span class="token punctuation">.</span>Companion<span class="token punctuation">.</span>closeAndFlush

<span class="token keyword">class</span> <span class="token function">ProxyDownstreamHandler</span><span class="token punctuation">(</span><span class="token keyword">private</span> <span class="token keyword">val</span> upstreamChannel<span class="token operator">:</span> Channel<span class="token punctuation">)</span> <span class="token operator">:</span> SimpleChannelInboundHandler<span class="token operator">&lt;</span>SipMessageEvent<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">channelRead0</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> ChannelHandlerContext<span class="token punctuation">,</span> event<span class="token operator">:</span> SipMessageEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">val</span> msg <span class="token operator">=</span> event<span class="token punctuation">.</span>message
        
        upstreamChannel<span class="token punctuation">.</span><span class="token function">writeAndFlush</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>ChannelFutureListener <span class="token punctuation">{</span> future<span class="token operator">:</span> ChannelFuture <span class="token operator">-></span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>future<span class="token punctuation">.</span>isSuccess<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">closeAndFlush</span><span class="token punctuation">(</span>future<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">channelInactive</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> ChannelHandlerContext<span class="token operator">?</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">closeAndFlush</span><span class="token punctuation">(</span>upstreamChannel<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">exceptionCaught</span><span class="token punctuation">(</span>ctx<span class="token operator">:</span> ChannelHandlerContext<span class="token punctuation">,</span> cause<span class="token operator">:</span> Throwable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cause<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">closeAndFlush</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>These are all the elements we need for our proxy to work.
The last step is to add the <code class="language-text">ProxyUpstreamHandler</code> to the pipeline in the <code class="language-text">ProxyApp</code> class:</p>
<div class="gatsby-highlight" data-language="kotlin"><pre style="counter-reset: linenumber NaN" class="language-kotlin line-numbers"><code class="language-kotlin">b<span class="token punctuation">.</span><span class="token function">group</span><span class="token punctuation">(</span>bossGroup<span class="token punctuation">,</span> workGroup<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">channel</span><span class="token punctuation">(</span>NioServerSocketChannel<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">.</span>java<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">childHandler</span><span class="token punctuation">(</span><span class="token keyword">object</span> <span class="token operator">:</span> ChannelInitializer<span class="token operator">&lt;</span>Channel<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">initChannel</span><span class="token punctuation">(</span>ch<span class="token operator">:</span> Channel<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">with</span><span class="token punctuation">(</span>ch<span class="token punctuation">.</span><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token function">addLast</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"decoder"</span></span><span class="token punctuation">,</span> <span class="token function">SipMessageStreamDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token function">addLast</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"encoder"</span></span><span class="token punctuation">,</span> <span class="token function">SipMessageEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token function">addLast</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"handler"</span></span><span class="token punctuation">,</span> <span class="token function">ProxyUpstreamHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// &lt;----</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2 id="create-a-test" style="position:relative;"><a href="#create-a-test" aria-label="create a test permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create a test</h2>
<p>To test the proxy I will use <a href="https://github.com/SIPp/sipp" target="_blank" rel="nofollow noopener noreferrer">the SIPp</a> application.
It allows to create <code class="language-text">XML</code> scenarios and send <code class="language-text">SIP</code> messages.
I’d say it is <a href="https://www.postman.com/" target="_blank" rel="nofollow noopener noreferrer">the Postman</a> equivalent for SIP protocol.</p>
<p>The test case will look exactly the same as the connection between Bob and Alice at the beginning of the post:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/fc64c37a9c81ce4c5b13a70179bbaff8/715a3/sip_flow.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 69.62025316455697%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB4UlEQVR42oVUyW7UUBD073LjhsQNvinckFhuKHDgEBGUQTjjjMceb8/rW+1C9Sa2bLK11PKblru6q+p5Aqximiac8gLjOK7LiI8pwttoU3PjiDTLfc86gg3gOOLL9yv0w7AMYLx++w6v3ryHMWZ5V2qDT99+PhgeOBlDdxFUt4cdYsTxnZ9O8BkgSVOcsmIzxLkRSXLCNDpusmRgu7+Q9Q0G8Rum2UEPFYx16LoOVVXBWgulFJxzHkwI4Wv8zef/Ebj2Bkr8ghLXcN0ORtXwS6y04abDMEBK6Yf0fQ8pNVpxhK6vfa8kRrNDYMUP1MevEPFn2OoSTRFCG+cb4zhegLhxXdcIwxB5nkObEV35B83dB5S3FxD7C7Txx60pDE7XWvumw+HggUh5zqZp/BBjLbRs4VQBPZxgZObPDwBJj87NW1Ernvk8m+EWc+bzk9fGXwcpF5pMbsutmayXZekHtW2LrmsJjWl2GdMWkJtRp6IofCMdJW3qyTqBuBndnd1/9mITkC/NDaSfJAmiKPJmEJwaKiWhjUVfJ2eHyyvYPnqaMsFIKcsyrxNpzzqSujEaWhso3tl+D9WG/qN4FJA6MUk7TVMPQOqzpnT/DGo8mxdNecw5SrHWbT5z8/t/gfsE/gFqcD4ekDYh7QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Simple SIP flow"
        title="Open image"
        src="/static/fc64c37a9c81ce4c5b13a70179bbaff8/f058b/sip_flow.png"
        srcset="/static/fc64c37a9c81ce4c5b13a70179bbaff8/c26ae/sip_flow.png 158w,
/static/fc64c37a9c81ce4c5b13a70179bbaff8/6bdcf/sip_flow.png 315w,
/static/fc64c37a9c81ce4c5b13a70179bbaff8/f058b/sip_flow.png 630w,
/static/fc64c37a9c81ce4c5b13a70179bbaff8/715a3/sip_flow.png 830w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
        decoding="async"
      />
  </a>
    </span></p>
<p>For this purpose, I defined the two scenarios:</p>
<div class="gatsby-highlight" data-language="xml"><pre style="counter-reset: linenumber NaN" class="language-xml line-numbers"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="ISO-8859-1" ?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">scenario</span> <span class="token name">SYSTEM</span> <span class="token string">"sipp.dtd"</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scenario</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Bob<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>send</span> <span class="token attr-name">retrans</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token cdata">&lt;![CDATA[

      INVITE sip:[service]@[remote_ip]:[remote_port] SIP/2.0
      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]
      From: sipp &lt;sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag00[call_number]
      To: [service] &lt;sip:[service]@[remote_ip]:[remote_port]>
      Call-ID: [call_id]
      CSeq: 1 INVITE
      Route: &lt;sip:127.0.0.1:[alices_port];transport=[transport];lr>
      Contact: sip:sipp@[local_ip]:[local_port]
      Max-Forwards: 70
      Content-Type: application/sdp
      Content-Length: 0

    ]]></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>send</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>recv</span> <span class="token attr-name">response</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>180<span class="token punctuation">"</span></span> <span class="token attr-name">optional</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>recv</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>recv</span> <span class="token attr-name">response</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">rtd</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>recv</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>send</span><span class="token punctuation">></span></span>
        <span class="token cdata">&lt;![CDATA[
      ACK sip:[service]@[remote_ip]:[remote_port] SIP/2.0
      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]
      From: sipp &lt;sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag00[call_number]
      To: [service] &lt;sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]
      Route: &lt;sip:127.0.0.1:[alices_port];transport=[transport];lr>
      Call-ID: [call_id]
      CSeq: 1 ACK
      Contact: sip:sipp@[local_ip]:[local_port]
      Max-Forwards: 70
      Content-Length: 0
    ]]></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>send</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>recv</span> <span class="token attr-name">request</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>BYE<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>recv</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>send</span><span class="token punctuation">></span></span>
        <span class="token cdata">&lt;![CDATA[

      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:]
      [last_Call-ID:]
      [last_CSeq:]
      Route: &lt;sip:127.0.0.1:[alices_port];transport=[transport];lr>
      Contact: &lt;sip:[local_ip]:[local_port];transport=[transport]>
      Content-Length: 0

    ]]></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>send</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scenario</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<div class="gatsby-highlight" data-language="xml"><pre style="counter-reset: linenumber NaN" class="language-xml line-numbers"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="ISO-8859-1" ?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">scenario</span> <span class="token name">SYSTEM</span> <span class="token string">"sipp.dtd"</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scenario</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Alice<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                                      -->
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>recv</span> <span class="token attr-name">request</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>INVITE<span class="token punctuation">"</span></span> <span class="token attr-name">crlf</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>recv</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>send</span><span class="token punctuation">></span></span>
        <span class="token cdata">&lt;![CDATA[

      SIP/2.0 180 Ringing
      [last_Via:]
      [last_From:]
      [last_To:];tag=[pid]SIPpTag01[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: &lt;sip:[local_ip]:[local_port];transport=[transport]>
      Content-Length: 0

    ]]></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>send</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pause</span> <span class="token attr-name">milliseconds</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3000<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>send</span> <span class="token attr-name">retrans</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token cdata">&lt;![CDATA[

      SIP/2.0 200 OK
      [last_Via:]
      [last_From:]
      [last_To:];tag=[pid]SIPpTag01[call_number]
      [last_Call-ID:]
      [last_CSeq:]
      Contact: &lt;sip:[local_ip]:[local_port];transport=[transport]>
      Content-Type: application/sdp
      Content-Length: 0

    ]]></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>send</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>recv</span> <span class="token attr-name">request</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ACK<span class="token punctuation">"</span></span>
          <span class="token attr-name">rtd</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span>
          <span class="token attr-name">crlf</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>recv</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pause</span> <span class="token attr-name">milliseconds</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>3000<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>send</span> <span class="token attr-name">retrans</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token cdata">&lt;![CDATA[
      BYE sip:[service]@[remote_ip]:[remote_port] SIP/2.0
      Via: SIP/2.0/[transport] [local_ip]:[local_port];branch=[branch]
      From: sipp &lt;sip:sipp@[local_ip]:[local_port]>;tag=[pid]SIPpTag00[call_number]
      To: [service] &lt;sip:[service]@[remote_ip]:[remote_port]>[peer_tag_param]
      Call-ID: [call_id]
      CSeq: 2 BYE
      Contact: sip:sipp@[local_ip]:[local_port]
      Max-Forwards: 70
      Subject: Performance Test
      Content-Length: 0
    ]]></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>send</span><span class="token punctuation">></span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>recv</span> <span class="token attr-name">response</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span> <span class="token attr-name">crlf</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>recv</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scenario</span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>and launch script:</p>
<div class="gatsby-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token shebang important">#!/usr/bin/env bash</span>

<span class="token comment"># Kill any existing sipp processes</span>
<span class="token function">pkill</span> sipp

<span class="token comment"># Start Alice's agent in background</span>
sipp <span class="token number">127.0</span>.0.1:5060 <span class="token parameter variable">-sf</span> alice.xml <span class="token parameter variable">-t</span> t1 <span class="token parameter variable">-m</span> <span class="token number">1</span> <span class="token parameter variable">-bg</span> <span class="token parameter variable">-trace_screen</span>

<span class="token comment"># Get the Alice's agent port (quite naive, I do not recommend using it in real tests)</span>
<span class="token assign-left variable">ALICES_PORT</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">sudo</span>  <span class="token function">netstat</span> <span class="token parameter variable">-ltnp</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"/sipp"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{ print $4 }'</span> <span class="token operator">|</span>  <span class="token function">grep</span> <span class="token parameter variable">-o</span> <span class="token string">"[^:]*$"</span><span class="token variable">)</span></span>

<span class="token comment"># Start Bob's agent</span>
sipp <span class="token number">127.0</span>.0.1:5060 <span class="token parameter variable">-sf</span> bob.xml <span class="token parameter variable">-t</span> t1 <span class="token parameter variable">-m</span> <span class="token number">1</span> <span class="token parameter variable">-key</span> alices_port <span class="token variable">${ALICES_PORT}</span> <span class="token parameter variable">-trace_screen</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Short description of <code class="language-text">sipp</code> parameters:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><code class="language-text">-sf</code></td>
<td>scenario file</td>
</tr>
<tr>
<td><code class="language-text">-t t1</code></td>
<td>use TCP</td>
</tr>
<tr>
<td><code class="language-text">-m1</code></td>
<td>perform 1 call</td>
</tr>
<tr>
<td><code class="language-text">-key alices_port ${ALICES_PORT}</code></td>
<td>set a key that will be available in the <code class="language-text">XML</code> scenario as <code class="language-text">[alices_port]</code></td>
</tr>
<tr>
<td>-trace_screen</td>
<td>generate a file with agent’s messages flow</td>
</tr>
</tbody>
</table>
<h2 id="run-the-test" style="position:relative;"><a href="#run-the-test" aria-label="run the test permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Run the test</h2>
<p>You need to install the <code class="language-text">SIPp</code> application to run the test.
And if you did, just:</p>
<ol>
<li>Run the proxy service from <code class="language-text">main</code> method.</li>
<li>Run the test shell script</li>
</ol>
<p>Both agents should generate <code class="language-text">*_screen.log</code> files with output similiar to this one:</p>
<div class="gatsby-highlight" data-language="text"><pre style="counter-reset: linenumber NaN" class="language-text line-numbers"><code class="language-text">------------------------------ Scenario Screen -------- [1-9]: Change Screen --
  Call rate (length)   Port   Total-time  Total-calls  Remote-host
  10.0(0 ms)/1.000s   5062       6.23 s            1  127.0.0.1:5060(TCP)

  Call limit 1 hit, 0.0 s period          0 ms scheduler resolution            
  0 calls (limit 30)                      Peak was 1 calls, after 0 s
  0 Running, 3 Paused, 0 Woken up
  0 dead call msg (discarded)             0 out-of-call msg (discarded)
  0 open sockets                          0/0/0 TCP errors (send/recv/cong)

                                 Messages  Retrans   Timeout   Unexpected-Msg
      INVITE ---------->         1         0         0                         
         180 &lt;----------         1         0         0         0               
         200 &lt;----------  E-RTD1 1         0         0         0               
         ACK ---------->         1         0                                   
         BYE &lt;----------         1         0         0         0               
         200 ---------->         1         0                                   
------- Waiting for active calls to end. Press [q] again to force exit. -------
----------------------------- Statistics Screen ------- [1-9]: Change Screen --
  Start Time             | 2021-06-16	17:45:29.353922	1625237129.353922         
  Last Reset Time        | 2021-06-16	17:45:35.591290	1625237135.591290         
  Current Time           | 2021-06-16	17:45:35.591325	1625237135.591325         
-------------------------+---------------------------+--------------------------
  Incoming calls created |        0                  |        0                 
  Outgoing calls created |        0                  |        1                 
  Total Calls created    |                           |        1                 
-------------------------+---------------------------+--------------------------
  Successful call        |        0                  |        1                 
  Failed call            |        0                  |        0                 
-------------------------+---------------------------+--------------------------
  Response Time 1        | 00:00:00:000000           | 00:00:00:000000          
  Call Length            | 00:00:00:000000           | 00:00:00:000000          
</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>And if you still don’t believe it works, you can run <a href="https://www.wireshark.org/" target="_blank" rel="nofollow noopener noreferrer">wireshark</a>
with a <code class="language-text">sip</code> filter before the test and check the captured packets.</p>
<h2 id="summary" style="position:relative;"><a href="#summary" aria-label="summary permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Summary</h2>
<p>In the above article I showed you how to create a SIP proxy service based on a <a href="https://www.sipstack.io/getstarted/" target="_blank" rel="nofollow noopener noreferrer">sipstack</a> library and <a href="https://netty.io/" target="_blank" rel="nofollow noopener noreferrer">netty</a> server.
This example is very simple and not entirely correct (more on that below), so I would rather not use it in serious systems 😊.
After all, during the writing of this article, I learned a lot and I hope that you will also find it useful.</p>
<p>I remind you that all the code can be found <a href="https://github.com/kkdrz/blog-examples/tree/main/sip-proxy-with-netty" target="_blank" rel="nofollow noopener noreferrer">on my github</a>.</p>
<h3 id="what-can-be-improved" style="position:relative;"><a href="#what-can-be-improved" aria-label="what can be improved permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What can be improved</h3>
<h4 id="the-routing-logic" style="position:relative;"><a href="#the-routing-logic" aria-label="the routing logic permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The routing logic</h4>
<p>The solution I have presented is not entirely compatible with how the SIP protocol works.
In fact, requests (<code class="language-text">INVITE</code>, <code class="language-text">ACK</code>, <code class="language-text">BYE</code>) can be based on the <code class="language-text">Route</code> header,
but after receiving such a message, the server should add the <code class="language-text">Via</code> header with its address.
The <code class="language-text">Via</code> headers are used for responses to find their way back the exact same path as the request took.
So each element in the network that processed this request should add it’s <code class="language-text">Via</code> header (sometimes there are exceptions to this rule).</p>
<p>So when the server receives a response, it should check if it’s address is in the latest <code class="language-text">Via</code> header.
Then it should delete this header and forward the message to the address that it found in the next <code class="language-text">Via</code> header.</p></section></article><div class="mt-4 m-auto px-2 pb-4 md:w-128"><h3>Other articles:</h3><div class="justify-around flex flex-col"><div class="mb-2"><a class="hover:no-underline" href="/custom-annotation-processor/"><div class="max-w-md mx-auto bg-white shadow-md hover:shadow-xl transition duration-200 ease-in-out overflow-hidden md:max-w-2xl"><div class="md:flex"><div class="md:flex-shrink-0 "><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper h-full w-full object-cover md:w-72"><div aria-hidden="true" style="padding-top:66.66666666666666%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGQAAAgMBAAAAAAAAAAAAAAAAAAMBAgQF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB7VH5iRwf/8QAGxAAAwACAwAAAAAAAAAAAAAAAQIDAAQREiH/2gAIAQEAAQUCb1rV6CLEz4ymutHVQo//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAcEAACAgIDAAAAAAAAAAAAAAAAAQIRIkEQIWL/2gAIAQEABj8CR60ZvLhSlfWikj//xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhQWEx/9oACAEBAAE/IQoFzlwHD7MQ6+zI27UTt+mSnoJ//9oADAMBAAIAAwAAABCDz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQACAgIDAAAAAAAAAAAAAAERIQAxQYFRYdH/2gAIAQEAAT8QGG9wG+Y33idiqdCXR1OCqZpEEXWq1GXAUvGQUVBV9YeO7jP/2Q==" alt=""/><picture><source type="image/avif" data-srcset="/static/b4f15350cd052a82cd4210a5938ef13e/b0356/featured.avif 750w,/static/b4f15350cd052a82cd4210a5938ef13e/48f75/featured.avif 1080w,/static/b4f15350cd052a82cd4210a5938ef13e/a5094/featured.avif 1366w,/static/b4f15350cd052a82cd4210a5938ef13e/f46cf/featured.avif 1920w" sizes="100vw"/><source type="image/webp" data-srcset="/static/b4f15350cd052a82cd4210a5938ef13e/57584/featured.webp 750w,/static/b4f15350cd052a82cd4210a5938ef13e/984df/featured.webp 1080w,/static/b4f15350cd052a82cd4210a5938ef13e/4a276/featured.webp 1366w,/static/b4f15350cd052a82cd4210a5938ef13e/9c00f/featured.webp 1920w" sizes="100vw"/><img data-gatsby-image-ssr="" class="h-full w-full object-cover md:w-72" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/b4f15350cd052a82cd4210a5938ef13e/5267c/featured.jpg" data-srcset="/static/b4f15350cd052a82cd4210a5938ef13e/7284f/featured.jpg 750w,/static/b4f15350cd052a82cd4210a5938ef13e/29ba9/featured.jpg 1080w,/static/b4f15350cd052a82cd4210a5938ef13e/c8896/featured.jpg 1366w,/static/b4f15350cd052a82cd4210a5938ef13e/5267c/featured.jpg 1920w" alt="Front Picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/b4f15350cd052a82cd4210a5938ef13e/b0356/featured.avif 750w,/static/b4f15350cd052a82cd4210a5938ef13e/48f75/featured.avif 1080w,/static/b4f15350cd052a82cd4210a5938ef13e/a5094/featured.avif 1366w,/static/b4f15350cd052a82cd4210a5938ef13e/f46cf/featured.avif 1920w" sizes="100vw"/><source type="image/webp" srcSet="/static/b4f15350cd052a82cd4210a5938ef13e/57584/featured.webp 750w,/static/b4f15350cd052a82cd4210a5938ef13e/984df/featured.webp 1080w,/static/b4f15350cd052a82cd4210a5938ef13e/4a276/featured.webp 1366w,/static/b4f15350cd052a82cd4210a5938ef13e/9c00f/featured.webp 1920w" sizes="100vw"/><img data-gatsby-image-ssr="" class="h-full w-full object-cover md:w-72" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/b4f15350cd052a82cd4210a5938ef13e/5267c/featured.jpg" srcSet="/static/b4f15350cd052a82cd4210a5938ef13e/7284f/featured.jpg 750w,/static/b4f15350cd052a82cd4210a5938ef13e/29ba9/featured.jpg 1080w,/static/b4f15350cd052a82cd4210a5938ef13e/c8896/featured.jpg 1366w,/static/b4f15350cd052a82cd4210a5938ef13e/5267c/featured.jpg 1920w" alt="Front Picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><div class="p-3"><div class="uppercase tracking-wide font-semibold text-gray-700">Custom Annotation Processor</div><div class="block mt-1 text-sm text-gray-600 leading-tight font-medium ">11 May 2021</div><p class="mt-2 text-gray-500">Have you ever written code that you felt could be generated without any problems?
It happened to me many times. That’s why I decided to share my experience with…</p></div></div></div></a></div><div class="mb-2"><a class="hover:no-underline" href="/map-of-localities-matching-the-pattern/"><div class="max-w-md mx-auto bg-white shadow-md hover:shadow-xl transition duration-200 ease-in-out overflow-hidden md:max-w-2xl"><div class="md:flex"><div class="md:flex-shrink-0 "><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper h-full w-full object-cover md:w-72"><div aria-hidden="true" style="padding-top:66.48721399730822%"></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB+klEQVR42p2T22sTURCH88/5IAhCQVDqkwRBiqGU9kWDWGz1wVAvxCAYEUoroiJSRGgViVooqPTBtIndW7ImbdMkTbKb3cTN5uwnuZi2aVrFHwxzLnO+w5kz42O/PA+E6Pj+9baJvf2Wpy8O8DFAnlOnkdFwF1/ibWc6i657MIbB6gE9IRCbKUTsDfWH05iTI9hjZ6lFprAX5rGfRnDmwjReRKkuL2HF3tKsGnsv6AG7E6eYx7xxGXtimN3INKXobao3RynPXMUeH8a6cgEz6KcQDVG6f53CTBAz/u1ooGuUqYQn2X1yh+JsGPPWGM7IaWpBP/XxcziBIZzRM5SioU7c4xA7r2ZxbesA1Lc/8XkpSXZpAeNuEPfiSVz/CRqXTlGfOE/l3jWqUwEKcw/IfnrH9ut5KsvvEaJ5OIdel27mttA/f6Dw7BG/AkPkn0fRV7+gJRMouk4quU4qsYaqaShaioyqIIR39C833CZpWWZDVsjGFsmsfETVf6IqCqqqdrwio/2Zr33HrpSPLxvLtsltZtuHFVlCbZnaBWgaqiz3Lmjt65rarpBj67CVT6NYoGJUyOpplBYkmUCVJDSpC2yZJFEql/9e2P2qGgZb8VUyX1dIr8dJ6zryxg/yO7l/65RBEkJQr9doOE57XLWstv03cFCzed7hXv4NOv7Bxl13JdYAAAAASUVORK5CYII=" alt=""/><picture><source type="image/avif" data-srcset="/static/76883c8778b65beea60b27f713e13503/87885/featured.avif 743w" sizes="100vw"/><source type="image/webp" data-srcset="/static/76883c8778b65beea60b27f713e13503/bf206/featured.webp 743w" sizes="100vw"/><img data-gatsby-image-ssr="" class="h-full w-full object-cover md:w-72" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" data-src="/static/76883c8778b65beea60b27f713e13503/97cbe/featured.png" data-srcset="/static/76883c8778b65beea60b27f713e13503/97cbe/featured.png 743w" alt="Front Picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/76883c8778b65beea60b27f713e13503/87885/featured.avif 743w" sizes="100vw"/><source type="image/webp" srcSet="/static/76883c8778b65beea60b27f713e13503/bf206/featured.webp 743w" sizes="100vw"/><img data-gatsby-image-ssr="" class="h-full w-full object-cover md:w-72" data-main-image="" style="opacity:0" sizes="100vw" decoding="async" loading="lazy" src="/static/76883c8778b65beea60b27f713e13503/97cbe/featured.png" srcSet="/static/76883c8778b65beea60b27f713e13503/97cbe/featured.png 743w" alt="Front Picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><div class="p-3"><div class="uppercase tracking-wide font-semibold text-gray-700">A Map of Localities Matching the Pattern</div><div class="block mt-1 text-sm text-gray-600 leading-tight font-medium ">11 July 2021</div><p class="mt-2 text-gray-500">Recently, interesting maps of Poland have been circulating on the Internet showing the occurrence of localities ending with various phrases (I have placed it…</p></div></div></div></a></div></div></div></main><footer class="flex flex-col text-white" style="background-color:#323232"><div><div class="md:w-128 w-full m-auto py-8 px-4 flex flex-col"><div class="uppercase pb-2 font-bold text-sm text-gray-100 mb-2">You can find me there:</div><div class="flex flex-col md:flex-row"><div class="grow mx-auto"><a href="https://www.facebook.com/drozdkonrad" class="text-gray-100 p-2 hover:text-blue-100" target="_blank" rel="noopener noreferrer"><svg aria-labelledby="svg-inline--fa-title-fVxHcKY8xoLT" data-prefix="fab" data-icon="square-facebook" class="svg-inline--fa fa-square-facebook fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><title id="svg-inline--fa-title-fVxHcKY8xoLT">Facebook</title><path fill="currentColor" d="M400 32H48A48 48 0 0 0 0 80v352a48 48 0 0 0 48 48h137.25V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.27c-30.81 0-40.42 19.12-40.42 38.73V256h68.78l-11 71.69h-57.78V480H400a48 48 0 0 0 48-48V80a48 48 0 0 0-48-48z"></path></svg></a><a href="https://github.com/kkdrz" class="text-gray-100 p-2 hover:text-blue-100" target="_blank" rel="noopener noreferrer"><svg aria-labelledby="svg-inline--fa-title-lodAMQYDUnyy" data-prefix="fab" data-icon="square-github" class="svg-inline--fa fa-square-github fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><title id="svg-inline--fa-title-lodAMQYDUnyy">Github</title><path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"></path></svg></a><a href="https://www.linkedin.com/in/konrad-drozd-3a1021121/" class="text-gray-100 p-2 hover:text-blue-100" target="_blank" rel="noopener noreferrer"><svg aria-labelledby="svg-inline--fa-title-TDH5H48gMrDW" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><title id="svg-inline--fa-title-TDH5H48gMrDW">LinkedIn</title><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a><a href="https://www.instagram.com/konradrzd/" class="text-gray-100 p-2 hover:text-blue-100" target="_blank" rel="noopener noreferrer"><svg aria-labelledby="svg-inline--fa-title-qKLqnAS6fbCg" data-prefix="fab" data-icon="square-instagram" class="svg-inline--fa fa-square-instagram fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><title id="svg-inline--fa-title-qKLqnAS6fbCg">Instagram</title><path fill="currentColor" d="M224,202.66A53.34,53.34,0,1,0,277.36,256,53.38,53.38,0,0,0,224,202.66Zm124.71-41a54,54,0,0,0-30.41-30.41c-21-8.29-71-6.43-94.3-6.43s-73.25-1.93-94.31,6.43a54,54,0,0,0-30.41,30.41c-8.28,21-6.43,71.05-6.43,94.33S91,329.26,99.32,350.33a54,54,0,0,0,30.41,30.41c21,8.29,71,6.43,94.31,6.43s73.24,1.93,94.3-6.43a54,54,0,0,0,30.41-30.41c8.35-21,6.43-71.05,6.43-94.33S357.1,182.74,348.75,161.67ZM224,338a82,82,0,1,1,82-82A81.9,81.9,0,0,1,224,338Zm85.38-148.3a19.14,19.14,0,1,1,19.13-19.14A19.1,19.1,0,0,1,309.42,189.74ZM400,32H48A48,48,0,0,0,0,80V432a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V80A48,48,0,0,0,400,32ZM382.88,322c-1.29,25.63-7.14,48.34-25.85,67s-41.4,24.63-67,25.85c-26.41,1.49-105.59,1.49-132,0-25.63-1.29-48.26-7.15-67-25.85s-24.63-41.42-25.85-67c-1.49-26.42-1.49-105.61,0-132,1.29-25.63,7.07-48.34,25.85-67s41.47-24.56,67-25.78c26.41-1.49,105.59-1.49,132,0,25.63,1.29,48.33,7.15,67,25.85s24.63,41.42,25.85,67.05C384.37,216.44,384.37,295.56,382.88,322Z"></path></svg></a><a href="mailto:konrad@kdrozd.pl" class="text-gray-100 p-2 hover:text-blue-100" target="_blank" rel="noopener noreferrer"><svg aria-labelledby="svg-inline--fa-title-Muxh1cFh5cIy" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-3x " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><title id="svg-inline--fa-title-Muxh1cFh5cIy">E-mail</title><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112c0 15.1 7.1 29.3 19.2 38.4L236.8 313.6c11.4 8.5 27 8.5 38.4 0L492.8 150.4c12.1-9.1 19.2-23.3 19.2-38.4c0-26.5-21.5-48-48-48H48zM0 176V384c0 35.3 28.7 64 64 64H448c35.3 0 64-28.7 64-64V176L294.4 339.2c-22.8 17.1-54 17.1-76.8 0L0 176z"></path></svg></a></div><div class="mx-auto mt-2 md:mt-0"><a href="https://www.buymeacoffee.com/kdrozd"><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&amp;emoji=&amp;slug=kdrozd&amp;button_colour=f3f4f6&amp;font_colour=000000&amp;font_family=Lato&amp;outline_colour=000000&amp;coffee_colour=FFDD00" alt="Buy me a coffee"/></a></div></div></div></div><div class="text-xs text-gray-300" style="background-color:#222"><div class="md:w-128 py-4 px-4 m-auto">Copyright © 2020-<!-- -->2023<!-- --> Konrad Drozd. All rights reserved.</div></div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-ZXMPLSG5ND"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-ZXMPLSG5ND', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/sip-proxy-with-netty-and-sipstack/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-e2885287d0d9895462cb.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-100a792e320399209e41.js\"],\"component---src-pages-about-js\":[\"/component---src-pages-about-js-4e5141dfe8f2bea75110.js\"],\"component---src-pages-admin-js\":[\"/component---src-pages-admin-js-8eb5dcfbdf6493310483.js\"],\"component---src-pages-blog-js\":[\"/component---src-pages-blog-js-eb796e6bd104c738c808.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-72f667a54f6a602281ff.js\"],\"component---src-templates-blog-post-js\":[\"/component---src-templates-blog-post-js-d660af94a7a3d74ce9a9.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="25cefe370c903bcbce6c";</script><script src="/webpack-runtime-71b3442f8af5cb1bd117.js" async></script><script src="/framework-161cdf7b50af50c02cef.js" async></script><script src="/app-e2885287d0d9895462cb.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>